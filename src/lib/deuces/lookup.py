import itertools
from lib.deuces.card import Card


class LookupTable:
    """
    Number of Distinct Hand Values:

    Straight Flush   10
    Four of a Kind   156      [(13 choose 2) * (2 choose 1)]
    Full Houses      156      [(13 choose 2) * (2 choose 1)]
    Flush            1277     [(13 choose 5) - 10 straight flushes]
    Straight         10
    Three of a Kind  858      [(13 choose 3) * (3 choose 1)]
    Two Pair         858      [(13 choose 3) * (3 choose 2)]
    One Pair         2860     [(13 choose 4) * (4 choose 1)]
    High Card      + 1277     [(13 choose 5) - 10 straights]
    -------------------------
    TOTAL            7462

    Here we create a lookup table which maps:
        5 card hand's unique prime product => rank in range [1, 7462]

    Examples:
    * Royal flush (best hand possible)          => 1
    * 7-5-4-3-2 unsuited (worst hand possible)  => 7462
    """
    MAX_STRAIGHT_FLUSH = 10
    MAX_FOUR_OF_A_KIND = 166
    MAX_FULL_HOUSE = 322
    MAX_FLUSH = 1599
    MAX_STRAIGHT = 1609
    MAX_THREE_OF_A_KIND = 2467
    MAX_TWO_PAIR = 3325
    MAX_PAIR = 6185
    MAX_HIGH_CARD = 7462

    MAX_TO_RANK_CLASS = {
        MAX_STRAIGHT_FLUSH: 1,
        MAX_FOUR_OF_A_KIND: 2,
        MAX_FULL_HOUSE: 3,
        MAX_FLUSH: 4,
        MAX_STRAIGHT: 5,
        MAX_THREE_OF_A_KIND: 6,
        MAX_TWO_PAIR: 7,
        MAX_PAIR: 8,
        MAX_HIGH_CARD: 9
    }

    RANK_CLASS_TO_STRING = {
        1: "Straight Flush",
        2: "Four of a Kind",
        3: "Full House",
        4: "Flush",
        5: "Straight",
        6: "Three of a Kind",
        7: "Two Pair",
        8: "Pair",
        9: "High Card"
    }

    TWO_EVAL = {
        (69634, 73730): 0.5233785822021115,
        (69634, 81922): 0.5233785822021115,
        (69634, 98306): 0.5233785822021115,
        (81922, 73730): 0.5233785822021115,
        (98306, 73730): 0.5233785822021115,
        (98306, 81922): 0.5233785822021115,
        (135427, 69634): 0.05731523378582204,
        (135427, 73730): 0.009049773755656076,
        (135427, 81922): 0.009049773755656076,
        (135427, 98306): 0.009049773755656076,
        (135427, 139523): 0.6485671191553545,
        (135427, 147715): 0.6485671191553545,
        (135427, 164099): 0.6485671191553545,
        (139523, 69634): 0.009049773755656076,
        (139523, 73730): 0.05731523378582204,
        (139523, 81922): 0.009049773755656076,
        (139523, 98306): 0.009049773755656076,
        (147715, 69634): 0.009049773755656076,
        (147715, 73730): 0.009049773755656076,
        (147715, 81922): 0.05731523378582204,
        (147715, 98306): 0.009049773755656076,
        (147715, 139523): 0.6485671191553545,
        (164099, 69634): 0.009049773755656076,
        (164099, 73730): 0.009049773755656076,
        (164099, 81922): 0.009049773755656076,
        (164099, 98306): 0.05731523378582204,
        (164099, 139523): 0.6485671191553545,
        (164099, 147715): 0.6485671191553545,
        (266757, 69634): 0.09653092006033182,
        (266757, 73730): 0.018099547511312264,
        (266757, 81922): 0.018099547511312264,
        (266757, 98306): 0.018099547511312264,
        (266757, 135427): 0.14479638009049778,
        (266757, 139523): 0.05429864253393668,
        (266757, 147715): 0.05429864253393668,
        (266757, 164099): 0.05429864253393668,
        (266757, 270853): 0.7526395173453997,
        (266757, 279045): 0.7526395173453997,
        (266757, 295429): 0.7526395173453997,
        (270853, 69634): 0.018099547511312264,
        (270853, 73730): 0.09653092006033182,
        (270853, 81922): 0.018099547511312264,
        (270853, 98306): 0.018099547511312264,
        (270853, 135427): 0.05429864253393668,
        (270853, 139523): 0.14479638009049778,
        (270853, 147715): 0.05429864253393668,
        (270853, 164099): 0.05429864253393668,
        (279045, 69634): 0.018099547511312264,
        (279045, 73730): 0.018099547511312264,
        (279045, 81922): 0.09653092006033182,
        (279045, 98306): 0.018099547511312264,
        (279045, 135427): 0.05429864253393668,
        (279045, 139523): 0.05429864253393668,
        (279045, 147715): 0.14479638009049778,
        (279045, 164099): 0.05429864253393668,
        (279045, 270853): 0.7526395173453997,
        (295429, 69634): 0.018099547511312264,
        (295429, 73730): 0.018099547511312264,
        (295429, 81922): 0.018099547511312264,
        (295429, 98306): 0.09653092006033182,
        (295429, 135427): 0.05429864253393668,
        (295429, 139523): 0.05429864253393668,
        (295429, 147715): 0.05429864253393668,
        (295429, 164099): 0.14479638009049778,
        (295429, 270853): 0.7526395173453997,
        (295429, 279045): 0.7526395173453997,
        (529159, 69634): 0.11161387631975872,
        (529159, 73730): 0.03619909502262442,
        (529159, 81922): 0.03619909502262442,
        (529159, 98306): 0.03619909502262442,
        (529159, 135427): 0.16892911010558065,
        (529159, 139523): 0.07541478129713419,
        (529159, 147715): 0.07541478129713419,
        (529159, 164099): 0.07541478129713419,
        (529159, 266757): 0.22926093514328805,
        (529159, 270853): 0.12971342383107087,
        (529159, 279045): 0.12971342383107087,
        (529159, 295429): 0.12971342383107087,
        (529159, 533255): 0.8657616892911011,
        (529159, 541447): 0.8657616892911011,
        (529159, 557831): 0.8657616892911011,
        (533255, 69634): 0.03619909502262442,
        (533255, 73730): 0.11161387631975872,
        (533255, 81922): 0.03619909502262442,
        (533255, 98306): 0.03619909502262442,
        (533255, 135427): 0.07541478129713419,
        (533255, 139523): 0.16892911010558065,
        (533255, 147715): 0.07541478129713419,
        (533255, 164099): 0.07541478129713419,
        (533255, 266757): 0.12971342383107087,
        (533255, 270853): 0.22926093514328805,
        (533255, 279045): 0.12971342383107087,
        (533255, 295429): 0.12971342383107087,
        (541447, 69634): 0.03619909502262442,
        (541447, 73730): 0.03619909502262442,
        (541447, 81922): 0.11161387631975872,
        (541447, 98306): 0.03619909502262442,
        (541447, 135427): 0.07541478129713419,
        (541447, 139523): 0.07541478129713419,
        (541447, 147715): 0.16892911010558065,
        (541447, 164099): 0.07541478129713419,
        (541447, 266757): 0.12971342383107087,
        (541447, 270853): 0.12971342383107087,
        (541447, 279045): 0.22926093514328805,
        (541447, 295429): 0.12971342383107087,
        (541447, 533255): 0.8657616892911011,
        (557831, 69634): 0.03619909502262442,
        (557831, 73730): 0.03619909502262442,
        (557831, 81922): 0.03619909502262442,
        (557831, 98306): 0.11161387631975872,
        (557831, 135427): 0.07541478129713419,
        (557831, 139523): 0.07541478129713419,
        (557831, 147715): 0.07541478129713419,
        (557831, 164099): 0.16892911010558065,
        (557831, 266757): 0.12971342383107087,
        (557831, 270853): 0.12971342383107087,
        (557831, 279045): 0.12971342383107087,
        (557831, 295429): 0.22926093514328805,
        (557831, 533255): 0.8657616892911011,
        (557831, 541447): 0.8657616892911011,
        (1053707, 69634): 0.10859728506787325,
        (1053707, 73730): 0.02714932126696834,
        (1053707, 81922): 0.02714932126696834,
        (1053707, 98306): 0.02714932126696834,
        (1053707, 135427): 0.1659125188536953,
        (1053707, 139523): 0.06636500754147812,
        (1053707, 147715): 0.06636500754147812,
        (1053707, 164099): 0.06636500754147812,
        (1053707, 266757): 0.2171945701357466,
        (1053707, 270853): 0.1206636500754148,
        (1053707, 279045): 0.1206636500754148,
        (1053707, 295429): 0.1206636500754148,
        (1053707, 529159): 0.277526395173454,
        (1053707, 533255): 0.17797888386123684,
        (1053707, 541447): 0.17797888386123684,
        (1053707, 557831): 0.17797888386123684,
        (1053707, 1057803): 0.9215686274509804,
        (1053707, 1065995): 0.9215686274509804,
        (1053707, 1082379): 0.9215686274509804,
        (1057803, 69634): 0.02714932126696834,
        (1057803, 73730): 0.10859728506787325,
        (1057803, 81922): 0.02714932126696834,
        (1057803, 98306): 0.02714932126696834,
        (1057803, 135427): 0.06636500754147812,
        (1057803, 139523): 0.1659125188536953,
        (1057803, 147715): 0.06636500754147812,
        (1057803, 164099): 0.06636500754147812,
        (1057803, 266757): 0.1206636500754148,
        (1057803, 270853): 0.2171945701357466,
        (1057803, 279045): 0.1206636500754148,
        (1057803, 295429): 0.1206636500754148,
        (1057803, 529159): 0.17797888386123684,
        (1057803, 533255): 0.277526395173454,
        (1057803, 541447): 0.17797888386123684,
        (1057803, 557831): 0.17797888386123684,
        (1065995, 69634): 0.02714932126696834,
        (1065995, 73730): 0.02714932126696834,
        (1065995, 81922): 0.10859728506787325,
        (1065995, 98306): 0.02714932126696834,
        (1065995, 135427): 0.06636500754147812,
        (1065995, 139523): 0.06636500754147812,
        (1065995, 147715): 0.1659125188536953,
        (1065995, 164099): 0.06636500754147812,
        (1065995, 266757): 0.1206636500754148,
        (1065995, 270853): 0.1206636500754148,
        (1065995, 279045): 0.2171945701357466,
        (1065995, 295429): 0.1206636500754148,
        (1065995, 529159): 0.17797888386123684,
        (1065995, 533255): 0.17797888386123684,
        (1065995, 541447): 0.277526395173454,
        (1065995, 557831): 0.17797888386123684,
        (1065995, 1057803): 0.9215686274509804,
        (1082379, 69634): 0.02714932126696834,
        (1082379, 73730): 0.02714932126696834,
        (1082379, 81922): 0.02714932126696834,
        (1082379, 98306): 0.10859728506787325,
        (1082379, 135427): 0.06636500754147812,
        (1082379, 139523): 0.06636500754147812,
        (1082379, 147715): 0.06636500754147812,
        (1082379, 164099): 0.1659125188536953,
        (1082379, 266757): 0.1206636500754148,
        (1082379, 270853): 0.1206636500754148,
        (1082379, 279045): 0.1206636500754148,
        (1082379, 295429): 0.2171945701357466,
        (1082379, 529159): 0.17797888386123684,
        (1082379, 533255): 0.17797888386123684,
        (1082379, 541447): 0.17797888386123684,
        (1082379, 557831): 0.277526395173454,
        (1082379, 1057803): 0.9215686274509804,
        (1082379, 1065995): 0.9215686274509804,
        (2102541, 69634): 0.13273001508295623,
        (2102541, 73730): 0.04524886877828049,
        (2102541, 81922): 0.04524886877828049,
        (2102541, 98306): 0.04524886877828049,
        (2102541, 135427): 0.19004524886877827,
        (2102541, 139523): 0.08446455505279038,
        (2102541, 147715): 0.08446455505279038,
        (2102541, 164099): 0.08446455505279038,
        (2102541, 266757): 0.2413273001508296,
        (2102541, 270853): 0.14177978883861242,
        (2102541, 279045): 0.14177978883861242,
        (2102541, 295429): 0.14177978883861242,
        (2102541, 529159): 0.301659125188537,
        (2102541, 533255): 0.2021116138763197,
        (2102541, 541447): 0.2021116138763197,
        (2102541, 557831): 0.2021116138763197,
        (2102541, 1053707): 0.3589743589743589,
        (2102541, 1057803): 0.25037707390648567,
        (2102541, 1065995): 0.25037707390648567,
        (2102541, 1082379): 0.25037707390648567,
        (2102541, 2106637): 0.9653092006033183,
        (2102541, 2114829): 0.9653092006033183,
        (2102541, 2131213): 0.9653092006033183,
        (2106637, 69634): 0.04524886877828049,
        (2106637, 73730): 0.13273001508295623,
        (2106637, 81922): 0.04524886877828049,
        (2106637, 98306): 0.04524886877828049,
        (2106637, 135427): 0.08446455505279038,
        (2106637, 139523): 0.19004524886877827,
        (2106637, 147715): 0.08446455505279038,
        (2106637, 164099): 0.08446455505279038,
        (2106637, 266757): 0.14177978883861242,
        (2106637, 270853): 0.2413273001508296,
        (2106637, 279045): 0.14177978883861242,
        (2106637, 295429): 0.14177978883861242,
        (2106637, 529159): 0.2021116138763197,
        (2106637, 533255): 0.301659125188537,
        (2106637, 541447): 0.2021116138763197,
        (2106637, 557831): 0.2021116138763197,
        (2106637, 1053707): 0.25037707390648567,
        (2106637, 1057803): 0.3589743589743589,
        (2106637, 1065995): 0.25037707390648567,
        (2106637, 1082379): 0.25037707390648567,
        (2114829, 69634): 0.04524886877828049,
        (2114829, 73730): 0.04524886877828049,
        (2114829, 81922): 0.13273001508295623,
        (2114829, 98306): 0.04524886877828049,
        (2114829, 135427): 0.08446455505279038,
        (2114829, 139523): 0.08446455505279038,
        (2114829, 147715): 0.19004524886877827,
        (2114829, 164099): 0.08446455505279038,
        (2114829, 266757): 0.14177978883861242,
        (2114829, 270853): 0.14177978883861242,
        (2114829, 279045): 0.2413273001508296,
        (2114829, 295429): 0.14177978883861242,
        (2114829, 529159): 0.2021116138763197,
        (2114829, 533255): 0.2021116138763197,
        (2114829, 541447): 0.301659125188537,
        (2114829, 557831): 0.2021116138763197,
        (2114829, 1053707): 0.25037707390648567,
        (2114829, 1057803): 0.25037707390648567,
        (2114829, 1065995): 0.3589743589743589,
        (2114829, 1082379): 0.25037707390648567,
        (2114829, 2106637): 0.9653092006033183,
        (2131213, 69634): 0.04524886877828049,
        (2131213, 73730): 0.04524886877828049,
        (2131213, 81922): 0.04524886877828049,
        (2131213, 98306): 0.13273001508295623,
        (2131213, 135427): 0.08446455505279038,
        (2131213, 139523): 0.08446455505279038,
        (2131213, 147715): 0.08446455505279038,
        (2131213, 164099): 0.19004524886877827,
        (2131213, 266757): 0.14177978883861242,
        (2131213, 270853): 0.14177978883861242,
        (2131213, 279045): 0.14177978883861242,
        (2131213, 295429): 0.2413273001508296,
        (2131213, 529159): 0.2021116138763197,
        (2131213, 533255): 0.2021116138763197,
        (2131213, 541447): 0.2021116138763197,
        (2131213, 557831): 0.301659125188537,
        (2131213, 1053707): 0.25037707390648567,
        (2131213, 1057803): 0.25037707390648567,
        (2131213, 1065995): 0.25037707390648567,
        (2131213, 1082379): 0.3589743589743589,
        (2131213, 2106637): 0.9653092006033183,
        (2131213, 2114829): 0.9653092006033183,
        (4199953, 69634): 0.19306184012066363,
        (4199953, 73730): 0.09351432880844646,
        (4199953, 81922): 0.09351432880844646,
        (4199953, 98306): 0.09351432880844646,
        (4199953, 135427): 0.21417797888386125,
        (4199953, 139523): 0.10558069381598789,
        (4199953, 147715): 0.10558069381598789,
        (4199953, 164099): 0.10558069381598789,
        (4199953, 266757): 0.27450980392156865,
        (4199953, 270853): 0.16289592760180993,
        (4199953, 279045): 0.16289592760180993,
        (4199953, 295429): 0.16289592760180993,
        (4199953, 529159): 0.33484162895927605,
        (4199953, 533255): 0.2262443438914027,
        (4199953, 541447): 0.2262443438914027,
        (4199953, 557831): 0.2262443438914027,
        (4199953, 1053707): 0.38612368024132726,
        (4199953, 1057803): 0.2865761689291101,
        (4199953, 1065995): 0.2865761689291101,
        (4199953, 1082379): 0.2865761689291101,
        (4199953, 2102541): 0.44645550527903466,
        (4199953, 2106637): 0.3469079939668175,
        (4199953, 2114829): 0.3469079939668175,
        (4199953, 2131213): 0.3469079939668175,
        (4199953, 4204049): 0.9728506787330317,
        (4199953, 4212241): 0.9728506787330317,
        (4199953, 4228625): 0.9728506787330317,
        (4204049, 69634): 0.09351432880844646,
        (4204049, 73730): 0.19306184012066363,
        (4204049, 81922): 0.09351432880844646,
        (4204049, 98306): 0.09351432880844646,
        (4204049, 135427): 0.10558069381598789,
        (4204049, 139523): 0.21417797888386125,
        (4204049, 147715): 0.10558069381598789,
        (4204049, 164099): 0.10558069381598789,
        (4204049, 266757): 0.16289592760180993,
        (4204049, 270853): 0.27450980392156865,
        (4204049, 279045): 0.16289592760180993,
        (4204049, 295429): 0.16289592760180993,
        (4204049, 529159): 0.2262443438914027,
        (4204049, 533255): 0.33484162895927605,
        (4204049, 541447): 0.2262443438914027,
        (4204049, 557831): 0.2262443438914027,
        (4204049, 1053707): 0.2865761689291101,
        (4204049, 1057803): 0.38612368024132726,
        (4204049, 1065995): 0.2865761689291101,
        (4204049, 1082379): 0.2865761689291101,
        (4204049, 2102541): 0.3469079939668175,
        (4204049, 2106637): 0.44645550527903466,
        (4204049, 2114829): 0.3469079939668175,
        (4204049, 2131213): 0.3469079939668175,
        (4212241, 69634): 0.09351432880844646,
        (4212241, 73730): 0.09351432880844646,
        (4212241, 81922): 0.19306184012066363,
        (4212241, 98306): 0.09351432880844646,
        (4212241, 135427): 0.10558069381598789,
        (4212241, 139523): 0.10558069381598789,
        (4212241, 147715): 0.21417797888386125,
        (4212241, 164099): 0.10558069381598789,
        (4212241, 266757): 0.16289592760180993,
        (4212241, 270853): 0.16289592760180993,
        (4212241, 279045): 0.27450980392156865,
        (4212241, 295429): 0.16289592760180993,
        (4212241, 529159): 0.2262443438914027,
        (4212241, 533255): 0.2262443438914027,
        (4212241, 541447): 0.33484162895927605,
        (4212241, 557831): 0.2262443438914027,
        (4212241, 1053707): 0.2865761689291101,
        (4212241, 1057803): 0.2865761689291101,
        (4212241, 1065995): 0.38612368024132726,
        (4212241, 1082379): 0.2865761689291101,
        (4212241, 2102541): 0.3469079939668175,
        (4212241, 2106637): 0.3469079939668175,
        (4212241, 2114829): 0.44645550527903466,
        (4212241, 2131213): 0.3469079939668175,
        (4212241, 4204049): 0.9728506787330317,
        (4228625, 69634): 0.09351432880844646,
        (4228625, 73730): 0.09351432880844646,
        (4228625, 81922): 0.09351432880844646,
        (4228625, 98306): 0.19306184012066363,
        (4228625, 135427): 0.10558069381598789,
        (4228625, 139523): 0.10558069381598789,
        (4228625, 147715): 0.10558069381598789,
        (4228625, 164099): 0.21417797888386125,
        (4228625, 266757): 0.16289592760180993,
        (4228625, 270853): 0.16289592760180993,
        (4228625, 279045): 0.16289592760180993,
        (4228625, 295429): 0.27450980392156865,
        (4228625, 529159): 0.2262443438914027,
        (4228625, 533255): 0.2262443438914027,
        (4228625, 541447): 0.2262443438914027,
        (4228625, 557831): 0.33484162895927605,
        (4228625, 1053707): 0.2865761689291101,
        (4228625, 1057803): 0.2865761689291101,
        (4228625, 1065995): 0.2865761689291101,
        (4228625, 1082379): 0.38612368024132726,
        (4228625, 2102541): 0.3469079939668175,
        (4228625, 2106637): 0.3469079939668175,
        (4228625, 2114829): 0.3469079939668175,
        (4228625, 2131213): 0.44645550527903466,
        (4228625, 4204049): 0.9728506787330317,
        (4228625, 4212241): 0.9728506787330317,
        (8394515, 69634): 0.25339366515837103,
        (8394515, 73730): 0.15384615384615385,
        (8394515, 81922): 0.15384615384615385,
        (8394515, 98306): 0.15384615384615385,
        (8394515, 135427): 0.28959276018099545,
        (8394515, 139523): 0.1870286576168929,
        (8394515, 147715): 0.1870286576168929,
        (8394515, 164099): 0.1870286576168929,
        (8394515, 266757): 0.30467571644042235,
        (8394515, 270853): 0.2111613876319759,
        (8394515, 279045): 0.2111613876319759,
        (8394515, 295429): 0.2111613876319759,
        (8394515, 529159): 0.36500754147812975,
        (8394515, 533255): 0.2714932126696833,
        (8394515, 541447): 0.2714932126696833,
        (8394515, 557831): 0.2714932126696833,
        (8394515, 1053707): 0.42533936651583715,
        (8394515, 1057803): 0.3318250377073907,
        (8394515, 1065995): 0.3318250377073907,
        (8394515, 1082379): 0.3318250377073907,
        (8394515, 2102541): 0.47662141779788836,
        (8394515, 2106637): 0.39517345399698345,
        (8394515, 2114829): 0.39517345399698345,
        (8394515, 2131213): 0.39517345399698345,
        (8394515, 4199953): 0.5414781297134239,
        (8394515, 4204049): 0.45550527903469085,
        (8394515, 4212241): 0.45550527903469085,
        (8394515, 4228625): 0.45550527903469085,
        (8394515, 8398611): 0.9773755656108597,
        (8394515, 8406803): 0.9773755656108597,
        (8394515, 8423187): 0.9773755656108597,
        (8398611, 69634): 0.15384615384615385,
        (8398611, 73730): 0.25339366515837103,
        (8398611, 81922): 0.15384615384615385,
        (8398611, 98306): 0.15384615384615385,
        (8398611, 135427): 0.1870286576168929,
        (8398611, 139523): 0.28959276018099545,
        (8398611, 147715): 0.1870286576168929,
        (8398611, 164099): 0.1870286576168929,
        (8398611, 266757): 0.2111613876319759,
        (8398611, 270853): 0.30467571644042235,
        (8398611, 279045): 0.2111613876319759,
        (8398611, 295429): 0.2111613876319759,
        (8398611, 529159): 0.2714932126696833,
        (8398611, 533255): 0.36500754147812975,
        (8398611, 541447): 0.2714932126696833,
        (8398611, 557831): 0.2714932126696833,
        (8398611, 1053707): 0.3318250377073907,
        (8398611, 1057803): 0.42533936651583715,
        (8398611, 1065995): 0.3318250377073907,
        (8398611, 1082379): 0.3318250377073907,
        (8398611, 2102541): 0.39517345399698345,
        (8398611, 2106637): 0.47662141779788836,
        (8398611, 2114829): 0.39517345399698345,
        (8398611, 2131213): 0.39517345399698345,
        (8398611, 4199953): 0.45550527903469085,
        (8398611, 4204049): 0.5414781297134239,
        (8398611, 4212241): 0.45550527903469085,
        (8398611, 4228625): 0.45550527903469085,
        (8406803, 69634): 0.15384615384615385,
        (8406803, 73730): 0.15384615384615385,
        (8406803, 81922): 0.25339366515837103,
        (8406803, 98306): 0.15384615384615385,
        (8406803, 135427): 0.1870286576168929,
        (8406803, 139523): 0.1870286576168929,
        (8406803, 147715): 0.28959276018099545,
        (8406803, 164099): 0.1870286576168929,
        (8406803, 266757): 0.2111613876319759,
        (8406803, 270853): 0.2111613876319759,
        (8406803, 279045): 0.30467571644042235,
        (8406803, 295429): 0.2111613876319759,
        (8406803, 529159): 0.2714932126696833,
        (8406803, 533255): 0.2714932126696833,
        (8406803, 541447): 0.36500754147812975,
        (8406803, 557831): 0.2714932126696833,
        (8406803, 1053707): 0.3318250377073907,
        (8406803, 1057803): 0.3318250377073907,
        (8406803, 1065995): 0.42533936651583715,
        (8406803, 1082379): 0.3318250377073907,
        (8406803, 2102541): 0.39517345399698345,
        (8406803, 2106637): 0.39517345399698345,
        (8406803, 2114829): 0.47662141779788836,
        (8406803, 2131213): 0.39517345399698345,
        (8406803, 4199953): 0.45550527903469085,
        (8406803, 4204049): 0.45550527903469085,
        (8406803, 4212241): 0.5414781297134239,
        (8406803, 4228625): 0.45550527903469085,
        (8406803, 8398611): 0.9773755656108597,
        (8423187, 69634): 0.15384615384615385,
        (8423187, 73730): 0.15384615384615385,
        (8423187, 81922): 0.15384615384615385,
        (8423187, 98306): 0.25339366515837103,
        (8423187, 135427): 0.1870286576168929,
        (8423187, 139523): 0.1870286576168929,
        (8423187, 147715): 0.1870286576168929,
        (8423187, 164099): 0.28959276018099545,
        (8423187, 266757): 0.2111613876319759,
        (8423187, 270853): 0.2111613876319759,
        (8423187, 279045): 0.2111613876319759,
        (8423187, 295429): 0.30467571644042235,
        (8423187, 529159): 0.2714932126696833,
        (8423187, 533255): 0.2714932126696833,
        (8423187, 541447): 0.2714932126696833,
        (8423187, 557831): 0.36500754147812975,
        (8423187, 1053707): 0.3318250377073907,
        (8423187, 1057803): 0.3318250377073907,
        (8423187, 1065995): 0.3318250377073907,
        (8423187, 1082379): 0.42533936651583715,
        (8423187, 2102541): 0.39517345399698345,
        (8423187, 2106637): 0.39517345399698345,
        (8423187, 2114829): 0.39517345399698345,
        (8423187, 2131213): 0.47662141779788836,
        (8423187, 4199953): 0.45550527903469085,
        (8423187, 4204049): 0.45550527903469085,
        (8423187, 4212241): 0.45550527903469085,
        (8423187, 4228625): 0.5414781297134239,
        (8423187, 8398611): 0.9773755656108597,
        (8423187, 8406803): 0.9773755656108597,
        (16783383, 69634): 0.3378582202111614,
        (16783383, 73730): 0.23831070889894423,
        (16783383, 81922): 0.23831070889894423,
        (16783383, 98306): 0.23831070889894423,
        (16783383, 135427): 0.3619909502262444,
        (16783383, 139523): 0.2624434389140271,
        (16783383, 147715): 0.2624434389140271,
        (16783383, 164099): 0.2624434389140271,
        (16783383, 266757): 0.3981900452488688,
        (16783383, 270853): 0.29864253393665163,
        (16783383, 279045): 0.29864253393665163,
        (16783383, 295429): 0.29864253393665163,
        (16783383, 529159): 0.41025641025641024,
        (16783383, 533255): 0.3137254901960784,
        (16783383, 541447): 0.3137254901960784,
        (16783383, 557831): 0.3137254901960784,
        (16783383, 1053707): 0.47058823529411764,
        (16783383, 1057803): 0.3740573152337858,
        (16783383, 1065995): 0.3740573152337858,
        (16783383, 1082379): 0.3740573152337858,
        (16783383, 2102541): 0.5384615384615384,
        (16783383, 2106637): 0.4434389140271493,
        (16783383, 2114829): 0.4434389140271493,
        (16783383, 2131213): 0.4434389140271493,
        (16783383, 4199953): 0.607843137254902,
        (16783383, 4204049): 0.5037707390648567,
        (16783383, 4212241): 0.5037707390648567,
        (16783383, 4228625): 0.5037707390648567,
        (16783383, 8394515): 0.6546003016591252,
        (16783383, 8398611): 0.5806938159879336,
        (16783383, 8406803): 0.5806938159879336,
        (16783383, 8423187): 0.5806938159879336,
        (16783383, 16787479): 0.9819004524886877,
        (16783383, 16795671): 0.9819004524886877,
        (16783383, 16812055): 0.9819004524886877,
        (16787479, 69634): 0.23831070889894423,
        (16787479, 73730): 0.3378582202111614,
        (16787479, 81922): 0.23831070889894423,
        (16787479, 98306): 0.23831070889894423,
        (16787479, 135427): 0.2624434389140271,
        (16787479, 139523): 0.3619909502262444,
        (16787479, 147715): 0.2624434389140271,
        (16787479, 164099): 0.2624434389140271,
        (16787479, 266757): 0.29864253393665163,
        (16787479, 270853): 0.3981900452488688,
        (16787479, 279045): 0.29864253393665163,
        (16787479, 295429): 0.29864253393665163,
        (16787479, 529159): 0.3137254901960784,
        (16787479, 533255): 0.41025641025641024,
        (16787479, 541447): 0.3137254901960784,
        (16787479, 557831): 0.3137254901960784,
        (16787479, 1053707): 0.3740573152337858,
        (16787479, 1057803): 0.47058823529411764,
        (16787479, 1065995): 0.3740573152337858,
        (16787479, 1082379): 0.3740573152337858,
        (16787479, 2102541): 0.4434389140271493,
        (16787479, 2106637): 0.5384615384615384,
        (16787479, 2114829): 0.4434389140271493,
        (16787479, 2131213): 0.4434389140271493,
        (16787479, 4199953): 0.5037707390648567,
        (16787479, 4204049): 0.607843137254902,
        (16787479, 4212241): 0.5037707390648567,
        (16787479, 4228625): 0.5037707390648567,
        (16787479, 8394515): 0.5806938159879336,
        (16787479, 8398611): 0.6546003016591252,
        (16787479, 8406803): 0.5806938159879336,
        (16787479, 8423187): 0.5806938159879336,
        (16795671, 69634): 0.23831070889894423,
        (16795671, 73730): 0.23831070889894423,
        (16795671, 81922): 0.3378582202111614,
        (16795671, 98306): 0.23831070889894423,
        (16795671, 135427): 0.2624434389140271,
        (16795671, 139523): 0.2624434389140271,
        (16795671, 147715): 0.3619909502262444,
        (16795671, 164099): 0.2624434389140271,
        (16795671, 266757): 0.29864253393665163,
        (16795671, 270853): 0.29864253393665163,
        (16795671, 279045): 0.3981900452488688,
        (16795671, 295429): 0.29864253393665163,
        (16795671, 529159): 0.3137254901960784,
        (16795671, 533255): 0.3137254901960784,
        (16795671, 541447): 0.41025641025641024,
        (16795671, 557831): 0.3137254901960784,
        (16795671, 1053707): 0.3740573152337858,
        (16795671, 1057803): 0.3740573152337858,
        (16795671, 1065995): 0.47058823529411764,
        (16795671, 1082379): 0.3740573152337858,
        (16795671, 2102541): 0.4434389140271493,
        (16795671, 2106637): 0.4434389140271493,
        (16795671, 2114829): 0.5384615384615384,
        (16795671, 2131213): 0.4434389140271493,
        (16795671, 4199953): 0.5037707390648567,
        (16795671, 4204049): 0.5037707390648567,
        (16795671, 4212241): 0.607843137254902,
        (16795671, 4228625): 0.5037707390648567,
        (16795671, 8394515): 0.5806938159879336,
        (16795671, 8398611): 0.5806938159879336,
        (16795671, 8406803): 0.6546003016591252,
        (16795671, 8423187): 0.5806938159879336,
        (16795671, 16787479): 0.9819004524886877,
        (16812055, 69634): 0.23831070889894423,
        (16812055, 73730): 0.23831070889894423,
        (16812055, 81922): 0.23831070889894423,
        (16812055, 98306): 0.3378582202111614,
        (16812055, 135427): 0.2624434389140271,
        (16812055, 139523): 0.2624434389140271,
        (16812055, 147715): 0.2624434389140271,
        (16812055, 164099): 0.3619909502262444,
        (16812055, 266757): 0.29864253393665163,
        (16812055, 270853): 0.29864253393665163,
        (16812055, 279045): 0.29864253393665163,
        (16812055, 295429): 0.3981900452488688,
        (16812055, 529159): 0.3137254901960784,
        (16812055, 533255): 0.3137254901960784,
        (16812055, 541447): 0.3137254901960784,
        (16812055, 557831): 0.41025641025641024,
        (16812055, 1053707): 0.3740573152337858,
        (16812055, 1057803): 0.3740573152337858,
        (16812055, 1065995): 0.3740573152337858,
        (16812055, 1082379): 0.47058823529411764,
        (16812055, 2102541): 0.4434389140271493,
        (16812055, 2106637): 0.4434389140271493,
        (16812055, 2114829): 0.4434389140271493,
        (16812055, 2131213): 0.5384615384615384,
        (16812055, 4199953): 0.5037707390648567,
        (16812055, 4204049): 0.5037707390648567,
        (16812055, 4212241): 0.5037707390648567,
        (16812055, 4228625): 0.607843137254902,
        (16812055, 8394515): 0.5806938159879336,
        (16812055, 8398611): 0.5806938159879336,
        (16812055, 8406803): 0.5806938159879336,
        (16812055, 8423187): 0.6546003016591252,
        (16812055, 16787479): 0.9819004524886877,
        (16812055, 16795671): 0.9819004524886877,
        (33560861, 69634): 0.4223227752639518,
        (33560861, 73730): 0.3227752639517345,
        (33560861, 81922): 0.3227752639517345,
        (33560861, 98306): 0.3227752639517345,
        (33560861, 135427): 0.4675716440422323,
        (33560861, 139523): 0.35595776772247356,
        (33560861, 147715): 0.35595776772247356,
        (33560861, 164099): 0.35595776772247356,
        (33560861, 266757): 0.473604826546003,
        (33560861, 270853): 0.3831070889894419,
        (33560861, 279045): 0.3831070889894419,
        (33560861, 295429): 0.3831070889894419,
        (33560861, 529159): 0.5067873303167421,
        (33560861, 533255): 0.4072398190045249,
        (33560861, 541447): 0.4072398190045249,
        (33560861, 557831): 0.4072398190045249,
        (33560861, 1053707): 0.5354449472096531,
        (33560861, 1057803): 0.4343891402714932,
        (33560861, 1065995): 0.4343891402714932,
        (33560861, 1082379): 0.4343891402714932,
        (33560861, 2102541): 0.5957767722473605,
        (33560861, 2106637): 0.4947209653092006,
        (33560861, 2114829): 0.4947209653092006,
        (33560861, 2131213): 0.4947209653092006,
        (33560861, 4199953): 0.6515837104072398,
        (33560861, 4204049): 0.5716440422322775,
        (33560861, 4212241): 0.5716440422322775,
        (33560861, 4228625): 0.5716440422322775,
        (33560861, 8394515): 0.7119155354449472,
        (33560861, 8398611): 0.6229260935143288,
        (33560861, 8406803): 0.6229260935143288,
        (33560861, 8423187): 0.6229260935143288,
        (33560861, 16783383): 0.7677224736048265,
        (33560861, 16787479): 0.6998491704374057,
        (33560861, 16795671): 0.6998491704374057,
        (33560861, 16812055): 0.6998491704374057,
        (33560861, 33564957): 0.9864253393665159,
        (33560861, 33573149): 0.9864253393665159,
        (33560861, 33589533): 0.9864253393665159,
        (33564957, 69634): 0.3227752639517345,
        (33564957, 73730): 0.4223227752639518,
        (33564957, 81922): 0.3227752639517345,
        (33564957, 98306): 0.3227752639517345,
        (33564957, 135427): 0.35595776772247356,
        (33564957, 139523): 0.4675716440422323,
        (33564957, 147715): 0.35595776772247356,
        (33564957, 164099): 0.35595776772247356,
        (33564957, 266757): 0.3831070889894419,
        (33564957, 270853): 0.473604826546003,
        (33564957, 279045): 0.3831070889894419,
        (33564957, 295429): 0.3831070889894419,
        (33564957, 529159): 0.4072398190045249,
        (33564957, 533255): 0.5067873303167421,
        (33564957, 541447): 0.4072398190045249,
        (33564957, 557831): 0.4072398190045249,
        (33564957, 1053707): 0.4343891402714932,
        (33564957, 1057803): 0.5354449472096531,
        (33564957, 1065995): 0.4343891402714932,
        (33564957, 1082379): 0.4343891402714932,
        (33564957, 2102541): 0.4947209653092006,
        (33564957, 2106637): 0.5957767722473605,
        (33564957, 2114829): 0.4947209653092006,
        (33564957, 2131213): 0.4947209653092006,
        (33564957, 4199953): 0.5716440422322775,
        (33564957, 4204049): 0.6515837104072398,
        (33564957, 4212241): 0.5716440422322775,
        (33564957, 4228625): 0.5716440422322775,
        (33564957, 8394515): 0.6229260935143288,
        (33564957, 8398611): 0.7119155354449472,
        (33564957, 8406803): 0.6229260935143288,
        (33564957, 8423187): 0.6229260935143288,
        (33564957, 16783383): 0.6998491704374057,
        (33564957, 16787479): 0.7677224736048265,
        (33564957, 16795671): 0.6998491704374057,
        (33564957, 16812055): 0.6998491704374057,
        (33573149, 69634): 0.3227752639517345,
        (33573149, 73730): 0.3227752639517345,
        (33573149, 81922): 0.4223227752639518,
        (33573149, 98306): 0.3227752639517345,
        (33573149, 135427): 0.35595776772247356,
        (33573149, 139523): 0.35595776772247356,
        (33573149, 147715): 0.4675716440422323,
        (33573149, 164099): 0.35595776772247356,
        (33573149, 266757): 0.3831070889894419,
        (33573149, 270853): 0.3831070889894419,
        (33573149, 279045): 0.473604826546003,
        (33573149, 295429): 0.3831070889894419,
        (33573149, 529159): 0.4072398190045249,
        (33573149, 533255): 0.4072398190045249,
        (33573149, 541447): 0.5067873303167421,
        (33573149, 557831): 0.4072398190045249,
        (33573149, 1053707): 0.4343891402714932,
        (33573149, 1057803): 0.4343891402714932,
        (33573149, 1065995): 0.5354449472096531,
        (33573149, 1082379): 0.4343891402714932,
        (33573149, 2102541): 0.4947209653092006,
        (33573149, 2106637): 0.4947209653092006,
        (33573149, 2114829): 0.5957767722473605,
        (33573149, 2131213): 0.4947209653092006,
        (33573149, 4199953): 0.5716440422322775,
        (33573149, 4204049): 0.5716440422322775,
        (33573149, 4212241): 0.6515837104072398,
        (33573149, 4228625): 0.5716440422322775,
        (33573149, 8394515): 0.6229260935143288,
        (33573149, 8398611): 0.6229260935143288,
        (33573149, 8406803): 0.7119155354449472,
        (33573149, 8423187): 0.6229260935143288,
        (33573149, 16783383): 0.6998491704374057,
        (33573149, 16787479): 0.6998491704374057,
        (33573149, 16795671): 0.7677224736048265,
        (33573149, 16812055): 0.6998491704374057,
        (33573149, 33564957): 0.9864253393665159,
        (33589533, 69634): 0.3227752639517345,
        (33589533, 73730): 0.3227752639517345,
        (33589533, 81922): 0.3227752639517345,
        (33589533, 98306): 0.4223227752639518,
        (33589533, 135427): 0.35595776772247356,
        (33589533, 139523): 0.35595776772247356,
        (33589533, 147715): 0.35595776772247356,
        (33589533, 164099): 0.4675716440422323,
        (33589533, 266757): 0.3831070889894419,
        (33589533, 270853): 0.3831070889894419,
        (33589533, 279045): 0.3831070889894419,
        (33589533, 295429): 0.473604826546003,
        (33589533, 529159): 0.4072398190045249,
        (33589533, 533255): 0.4072398190045249,
        (33589533, 541447): 0.4072398190045249,
        (33589533, 557831): 0.5067873303167421,
        (33589533, 1053707): 0.4343891402714932,
        (33589533, 1057803): 0.4343891402714932,
        (33589533, 1065995): 0.4343891402714932,
        (33589533, 1082379): 0.5354449472096531,
        (33589533, 2102541): 0.4947209653092006,
        (33589533, 2106637): 0.4947209653092006,
        (33589533, 2114829): 0.4947209653092006,
        (33589533, 2131213): 0.5957767722473605,
        (33589533, 4199953): 0.5716440422322775,
        (33589533, 4204049): 0.5716440422322775,
        (33589533, 4212241): 0.5716440422322775,
        (33589533, 4228625): 0.6515837104072398,
        (33589533, 8394515): 0.6229260935143288,
        (33589533, 8398611): 0.6229260935143288,
        (33589533, 8406803): 0.6229260935143288,
        (33589533, 8423187): 0.7119155354449472,
        (33589533, 16783383): 0.6998491704374057,
        (33589533, 16787479): 0.6998491704374057,
        (33589533, 16795671): 0.6998491704374057,
        (33589533, 16812055): 0.7677224736048265,
        (33589533, 33564957): 0.9864253393665159,
        (33589533, 33573149): 0.9864253393665159,
        (67115551, 69634): 0.5188536953242835,
        (67115551, 73730): 0.4193061840120663,
        (67115551, 81922): 0.4193061840120663,
        (67115551, 98306): 0.4193061840120663,
        (67115551, 135427): 0.5444947209653093,
        (67115551, 139523): 0.4645550527903469,
        (67115551, 147715): 0.4645550527903469,
        (67115551, 164099): 0.4645550527903469,
        (67115551, 266757): 0.5927601809954751,
        (67115551, 270853): 0.48567119155354455,
        (67115551, 279045): 0.48567119155354455,
        (67115551, 295429): 0.48567119155354455,
        (67115551, 529159): 0.6108597285067874,
        (67115551, 533255): 0.5158371040723981,
        (67115551, 541447): 0.5158371040723981,
        (67115551, 557831): 0.5158371040723981,
        (67115551, 1053707): 0.6440422322775263,
        (67115551, 1057803): 0.5535444947209653,
        (67115551, 1065995): 0.5535444947209653,
        (67115551, 1082379): 0.5535444947209653,
        (67115551, 2102541): 0.6696832579185521,
        (67115551, 2106637): 0.5897435897435898,
        (67115551, 2114829): 0.5897435897435898,
        (67115551, 2131213): 0.5897435897435898,
        (67115551, 4199953): 0.7269984917043741,
        (67115551, 4204049): 0.641025641025641,
        (67115551, 4212241): 0.641025641025641,
        (67115551, 4228625): 0.641025641025641,
        (67115551, 8394515): 0.7737556561085973,
        (67115551, 8398611): 0.7088989441930618,
        (67115551, 8406803): 0.7088989441930618,
        (67115551, 8423187): 0.7088989441930618,
        (67115551, 16783383): 0.8310708898944192,
        (67115551, 16787479): 0.7616892911010558,
        (67115551, 16795671): 0.7616892911010558,
        (67115551, 16812055): 0.7616892911010558,
        (67115551, 33560861): 0.861236802413273,
        (67115551, 33564957): 0.8099547511312217,
        (67115551, 33573149): 0.8099547511312217,
        (67115551, 33589533): 0.8099547511312217,
        (67115551, 67119647): 0.9909502262443439,
        (67115551, 67127839): 0.9909502262443439,
        (67115551, 67144223): 0.9909502262443439,
        (67119647, 69634): 0.4193061840120663,
        (67119647, 73730): 0.5188536953242835,
        (67119647, 81922): 0.4193061840120663,
        (67119647, 98306): 0.4193061840120663,
        (67119647, 135427): 0.4645550527903469,
        (67119647, 139523): 0.5444947209653093,
        (67119647, 147715): 0.4645550527903469,
        (67119647, 164099): 0.4645550527903469,
        (67119647, 266757): 0.48567119155354455,
        (67119647, 270853): 0.5927601809954751,
        (67119647, 279045): 0.48567119155354455,
        (67119647, 295429): 0.48567119155354455,
        (67119647, 529159): 0.5158371040723981,
        (67119647, 533255): 0.6108597285067874,
        (67119647, 541447): 0.5158371040723981,
        (67119647, 557831): 0.5158371040723981,
        (67119647, 1053707): 0.5535444947209653,
        (67119647, 1057803): 0.6440422322775263,
        (67119647, 1065995): 0.5535444947209653,
        (67119647, 1082379): 0.5535444947209653,
        (67119647, 2102541): 0.5897435897435898,
        (67119647, 2106637): 0.6696832579185521,
        (67119647, 2114829): 0.5897435897435898,
        (67119647, 2131213): 0.5897435897435898,
        (67119647, 4199953): 0.641025641025641,
        (67119647, 4204049): 0.7269984917043741,
        (67119647, 4212241): 0.641025641025641,
        (67119647, 4228625): 0.641025641025641,
        (67119647, 8394515): 0.7088989441930618,
        (67119647, 8398611): 0.7737556561085973,
        (67119647, 8406803): 0.7088989441930618,
        (67119647, 8423187): 0.7088989441930618,
        (67119647, 16783383): 0.7616892911010558,
        (67119647, 16787479): 0.8310708898944192,
        (67119647, 16795671): 0.7616892911010558,
        (67119647, 16812055): 0.7616892911010558,
        (67119647, 33560861): 0.8099547511312217,
        (67119647, 33564957): 0.861236802413273,
        (67119647, 33573149): 0.8099547511312217,
        (67119647, 33589533): 0.8099547511312217,
        (67127839, 69634): 0.4193061840120663,
        (67127839, 73730): 0.4193061840120663,
        (67127839, 81922): 0.5188536953242835,
        (67127839, 98306): 0.4193061840120663,
        (67127839, 135427): 0.4645550527903469,
        (67127839, 139523): 0.4645550527903469,
        (67127839, 147715): 0.5444947209653093,
        (67127839, 164099): 0.4645550527903469,
        (67127839, 266757): 0.48567119155354455,
        (67127839, 270853): 0.48567119155354455,
        (67127839, 279045): 0.5927601809954751,
        (67127839, 295429): 0.48567119155354455,
        (67127839, 529159): 0.5158371040723981,
        (67127839, 533255): 0.5158371040723981,
        (67127839, 541447): 0.6108597285067874,
        (67127839, 557831): 0.5158371040723981,
        (67127839, 1053707): 0.5535444947209653,
        (67127839, 1057803): 0.5535444947209653,
        (67127839, 1065995): 0.6440422322775263,
        (67127839, 1082379): 0.5535444947209653,
        (67127839, 2102541): 0.5897435897435898,
        (67127839, 2106637): 0.5897435897435898,
        (67127839, 2114829): 0.6696832579185521,
        (67127839, 2131213): 0.5897435897435898,
        (67127839, 4199953): 0.641025641025641,
        (67127839, 4204049): 0.641025641025641,
        (67127839, 4212241): 0.7269984917043741,
        (67127839, 4228625): 0.641025641025641,
        (67127839, 8394515): 0.7088989441930618,
        (67127839, 8398611): 0.7088989441930618,
        (67127839, 8406803): 0.7737556561085973,
        (67127839, 8423187): 0.7088989441930618,
        (67127839, 16783383): 0.7616892911010558,
        (67127839, 16787479): 0.7616892911010558,
        (67127839, 16795671): 0.8310708898944192,
        (67127839, 16812055): 0.7616892911010558,
        (67127839, 33560861): 0.8099547511312217,
        (67127839, 33564957): 0.8099547511312217,
        (67127839, 33573149): 0.861236802413273,
        (67127839, 33589533): 0.8099547511312217,
        (67127839, 67119647): 0.9909502262443439,
        (67144223, 69634): 0.4193061840120663,
        (67144223, 73730): 0.4193061840120663,
        (67144223, 81922): 0.4193061840120663,
        (67144223, 98306): 0.5188536953242835,
        (67144223, 135427): 0.4645550527903469,
        (67144223, 139523): 0.4645550527903469,
        (67144223, 147715): 0.4645550527903469,
        (67144223, 164099): 0.5444947209653093,
        (67144223, 266757): 0.48567119155354455,
        (67144223, 270853): 0.48567119155354455,
        (67144223, 279045): 0.48567119155354455,
        (67144223, 295429): 0.5927601809954751,
        (67144223, 529159): 0.5158371040723981,
        (67144223, 533255): 0.5158371040723981,
        (67144223, 541447): 0.5158371040723981,
        (67144223, 557831): 0.6108597285067874,
        (67144223, 1053707): 0.5535444947209653,
        (67144223, 1057803): 0.5535444947209653,
        (67144223, 1065995): 0.5535444947209653,
        (67144223, 1082379): 0.6440422322775263,
        (67144223, 2102541): 0.5897435897435898,
        (67144223, 2106637): 0.5897435897435898,
        (67144223, 2114829): 0.5897435897435898,
        (67144223, 2131213): 0.6696832579185521,
        (67144223, 4199953): 0.641025641025641,
        (67144223, 4204049): 0.641025641025641,
        (67144223, 4212241): 0.641025641025641,
        (67144223, 4228625): 0.7269984917043741,
        (67144223, 8394515): 0.7088989441930618,
        (67144223, 8398611): 0.7088989441930618,
        (67144223, 8406803): 0.7088989441930618,
        (67144223, 8423187): 0.7737556561085973,
        (67144223, 16783383): 0.7616892911010558,
        (67144223, 16787479): 0.7616892911010558,
        (67144223, 16795671): 0.7616892911010558,
        (67144223, 16812055): 0.8310708898944192,
        (67144223, 33560861): 0.8099547511312217,
        (67144223, 33564957): 0.8099547511312217,
        (67144223, 33573149): 0.8099547511312217,
        (67144223, 33589533): 0.861236802413273,
        (67144223, 67119647): 0.9909502262443439,
        (67144223, 67127839): 0.9909502262443439,
        (134224677, 69634): 0.6138763197586727,
        (134224677, 73730): 0.5324283559577677,
        (134224677, 81922): 0.5324283559577677,
        (134224677, 98306): 0.5324283559577677,
        (134224677, 135427): 0.6576168929110106,
        (134224677, 139523): 0.5625942684766214,
        (134224677, 147715): 0.5625942684766214,
        (134224677, 164099): 0.5625942684766214,
        (134224677, 266757): 0.6726998491704375,
        (134224677, 270853): 0.6048265460030167,
        (134224677, 279045): 0.6048265460030167,
        (134224677, 295429): 0.6048265460030167,
        (134224677, 529159): 0.7149321266968326,
        (134224677, 533255): 0.6319758672699849,
        (134224677, 541447): 0.6319758672699849,
        (134224677, 557831): 0.6319758672699849,
        (134224677, 1053707): 0.7390648567119156,
        (134224677, 1057803): 0.6666666666666667,
        (134224677, 1065995): 0.6666666666666667,
        (134224677, 1082379): 0.6666666666666667,
        (134224677, 2102541): 0.770739064856712,
        (134224677, 2106637): 0.6907993966817496,
        (134224677, 2114829): 0.6907993966817496,
        (134224677, 2131213): 0.6907993966817496,
        (134224677, 4199953): 0.8159879336349924,
        (134224677, 4204049): 0.7360482654600302,
        (134224677, 4212241): 0.7360482654600302,
        (134224677, 4228625): 0.7360482654600302,
        (134224677, 8394515): 0.8582202111613877,
        (134224677, 8398611): 0.8009049773755657,
        (134224677, 8406803): 0.8009049773755657,
        (134224677, 8423187): 0.8009049773755657,
        (134224677, 16783383): 0.8989441930618401,
        (134224677, 16787479): 0.8401206636500754,
        (134224677, 16795671): 0.8401206636500754,
        (134224677, 16812055): 0.8401206636500754,
        (134224677, 33560861): 0.9049773755656109,
        (134224677, 33564957): 0.8748114630467572,
        (134224677, 33573149): 0.8748114630467572,
        (134224677, 33589533): 0.8748114630467572,
        (134224677, 67115551): 0.9245852187028658,
        (134224677, 67119647): 0.8959276018099548,
        (134224677, 67127839): 0.8959276018099548,
        (134224677, 67144223): 0.8959276018099548,
        (134224677, 134228773): 0.995475113122172,
        (134224677, 134236965): 0.995475113122172,
        (134224677, 134253349): 0.995475113122172,
        (134228773, 69634): 0.5324283559577677,
        (134228773, 73730): 0.6138763197586727,
        (134228773, 81922): 0.5324283559577677,
        (134228773, 98306): 0.5324283559577677,
        (134228773, 135427): 0.5625942684766214,
        (134228773, 139523): 0.6576168929110106,
        (134228773, 147715): 0.5625942684766214,
        (134228773, 164099): 0.5625942684766214,
        (134228773, 266757): 0.6048265460030167,
        (134228773, 270853): 0.6726998491704375,
        (134228773, 279045): 0.6048265460030167,
        (134228773, 295429): 0.6048265460030167,
        (134228773, 529159): 0.6319758672699849,
        (134228773, 533255): 0.7149321266968326,
        (134228773, 541447): 0.6319758672699849,
        (134228773, 557831): 0.6319758672699849,
        (134228773, 1053707): 0.6666666666666667,
        (134228773, 1057803): 0.7390648567119156,
        (134228773, 1065995): 0.6666666666666667,
        (134228773, 1082379): 0.6666666666666667,
        (134228773, 2102541): 0.6907993966817496,
        (134228773, 2106637): 0.770739064856712,
        (134228773, 2114829): 0.6907993966817496,
        (134228773, 2131213): 0.6907993966817496,
        (134228773, 4199953): 0.7360482654600302,
        (134228773, 4204049): 0.8159879336349924,
        (134228773, 4212241): 0.7360482654600302,
        (134228773, 4228625): 0.7360482654600302,
        (134228773, 8394515): 0.8009049773755657,
        (134228773, 8398611): 0.8582202111613877,
        (134228773, 8406803): 0.8009049773755657,
        (134228773, 8423187): 0.8009049773755657,
        (134228773, 16783383): 0.8401206636500754,
        (134228773, 16787479): 0.8989441930618401,
        (134228773, 16795671): 0.8401206636500754,
        (134228773, 16812055): 0.8401206636500754,
        (134228773, 33560861): 0.8748114630467572,
        (134228773, 33564957): 0.9049773755656109,
        (134228773, 33573149): 0.8748114630467572,
        (134228773, 33589533): 0.8748114630467572,
        (134228773, 67115551): 0.8959276018099548,
        (134228773, 67119647): 0.9245852187028658,
        (134228773, 67127839): 0.8959276018099548,
        (134228773, 67144223): 0.8959276018099548,
        (134236965, 69634): 0.5324283559577677,
        (134236965, 73730): 0.5324283559577677,
        (134236965, 81922): 0.6138763197586727,
        (134236965, 98306): 0.5324283559577677,
        (134236965, 135427): 0.5625942684766214,
        (134236965, 139523): 0.5625942684766214,
        (134236965, 147715): 0.6576168929110106,
        (134236965, 164099): 0.5625942684766214,
        (134236965, 266757): 0.6048265460030167,
        (134236965, 270853): 0.6048265460030167,
        (134236965, 279045): 0.6726998491704375,
        (134236965, 295429): 0.6048265460030167,
        (134236965, 529159): 0.6319758672699849,
        (134236965, 533255): 0.6319758672699849,
        (134236965, 541447): 0.7149321266968326,
        (134236965, 557831): 0.6319758672699849,
        (134236965, 1053707): 0.6666666666666667,
        (134236965, 1057803): 0.6666666666666667,
        (134236965, 1065995): 0.7390648567119156,
        (134236965, 1082379): 0.6666666666666667,
        (134236965, 2102541): 0.6907993966817496,
        (134236965, 2106637): 0.6907993966817496,
        (134236965, 2114829): 0.770739064856712,
        (134236965, 2131213): 0.6907993966817496,
        (134236965, 4199953): 0.7360482654600302,
        (134236965, 4204049): 0.7360482654600302,
        (134236965, 4212241): 0.8159879336349924,
        (134236965, 4228625): 0.7360482654600302,
        (134236965, 8394515): 0.8009049773755657,
        (134236965, 8398611): 0.8009049773755657,
        (134236965, 8406803): 0.8582202111613877,
        (134236965, 8423187): 0.8009049773755657,
        (134236965, 16783383): 0.8401206636500754,
        (134236965, 16787479): 0.8401206636500754,
        (134236965, 16795671): 0.8989441930618401,
        (134236965, 16812055): 0.8401206636500754,
        (134236965, 33560861): 0.8748114630467572,
        (134236965, 33564957): 0.8748114630467572,
        (134236965, 33573149): 0.9049773755656109,
        (134236965, 33589533): 0.8748114630467572,
        (134236965, 67115551): 0.8959276018099548,
        (134236965, 67119647): 0.8959276018099548,
        (134236965, 67127839): 0.9245852187028658,
        (134236965, 67144223): 0.8959276018099548,
        (134236965, 134228773): 0.995475113122172,
        (134253349, 69634): 0.5324283559577677,
        (134253349, 73730): 0.5324283559577677,
        (134253349, 81922): 0.5324283559577677,
        (134253349, 98306): 0.6138763197586727,
        (134253349, 135427): 0.5625942684766214,
        (134253349, 139523): 0.5625942684766214,
        (134253349, 147715): 0.5625942684766214,
        (134253349, 164099): 0.6576168929110106,
        (134253349, 266757): 0.6048265460030167,
        (134253349, 270853): 0.6048265460030167,
        (134253349, 279045): 0.6048265460030167,
        (134253349, 295429): 0.6726998491704375,
        (134253349, 529159): 0.6319758672699849,
        (134253349, 533255): 0.6319758672699849,
        (134253349, 541447): 0.6319758672699849,
        (134253349, 557831): 0.7149321266968326,
        (134253349, 1053707): 0.6666666666666667,
        (134253349, 1057803): 0.6666666666666667,
        (134253349, 1065995): 0.6666666666666667,
        (134253349, 1082379): 0.7390648567119156,
        (134253349, 2102541): 0.6907993966817496,
        (134253349, 2106637): 0.6907993966817496,
        (134253349, 2114829): 0.6907993966817496,
        (134253349, 2131213): 0.770739064856712,
        (134253349, 4199953): 0.7360482654600302,
        (134253349, 4204049): 0.7360482654600302,
        (134253349, 4212241): 0.7360482654600302,
        (134253349, 4228625): 0.8159879336349924,
        (134253349, 8394515): 0.8009049773755657,
        (134253349, 8398611): 0.8009049773755657,
        (134253349, 8406803): 0.8009049773755657,
        (134253349, 8423187): 0.8582202111613877,
        (134253349, 16783383): 0.8401206636500754,
        (134253349, 16787479): 0.8401206636500754,
        (134253349, 16795671): 0.8401206636500754,
        (134253349, 16812055): 0.8989441930618401,
        (134253349, 33560861): 0.8748114630467572,
        (134253349, 33564957): 0.8748114630467572,
        (134253349, 33573149): 0.8748114630467572,
        (134253349, 33589533): 0.9049773755656109,
        (134253349, 67115551): 0.8959276018099548,
        (134253349, 67119647): 0.8959276018099548,
        (134253349, 67127839): 0.8959276018099548,
        (134253349, 67144223): 0.9245852187028658,
        (134253349, 134228773): 0.995475113122172,
        (134253349, 134236965): 0.995475113122172,
        (268442665, 69634): 0.7647058823529411,
        (268442665, 73730): 0.6817496229260935,
        (268442665, 81922): 0.6817496229260935,
        (268442665, 98306): 0.6817496229260935,
        (268442665, 135427): 0.8129713423831071,
        (268442665, 139523): 0.7239819004524887,
        (268442665, 147715): 0.7239819004524887,
        (268442665, 164099): 0.7239819004524887,
        (268442665, 266757): 0.8280542986425339,
        (268442665, 270853): 0.7481146304675717,
        (268442665, 279045): 0.7481146304675717,
        (268442665, 295429): 0.7481146304675717,
        (268442665, 529159): 0.8552036199095022,
        (268442665, 533255): 0.7918552036199095,
        (268442665, 541447): 0.7918552036199095,
        (268442665, 557831): 0.7918552036199095,
        (268442665, 1053707): 0.8521870286576169,
        (268442665, 1057803): 0.7828054298642534,
        (268442665, 1065995): 0.7828054298642534,
        (268442665, 1082379): 0.7828054298642534,
        (268442665, 2102541): 0.8868778280542986,
        (268442665, 2106637): 0.8250377073906485,
        (268442665, 2114829): 0.8250377073906485,
        (268442665, 2131213): 0.8250377073906485,
        (268442665, 4199953): 0.9019607843137255,
        (268442665, 4204049): 0.8491704374057315,
        (268442665, 4212241): 0.8491704374057315,
        (268442665, 4228625): 0.8491704374057315,
        (268442665, 8394515): 0.9170437405731523,
        (268442665, 8398611): 0.8838612368024132,
        (268442665, 8406803): 0.8838612368024132,
        (268442665, 8423187): 0.8838612368024132,
        (268442665, 16783383): 0.9457013574660633,
        (268442665, 16787479): 0.9140271493212669,
        (268442665, 16795671): 0.9140271493212669,
        (268442665, 16812055): 0.9140271493212669,
        (268442665, 33560861): 0.9577677224736049,
        (268442665, 33564957): 0.9336349924585219,
        (268442665, 33573149): 0.9336349924585219,
        (268442665, 33589533): 0.9336349924585219,
        (268442665, 67115551): 0.9607843137254902,
        (268442665, 67119647): 0.942684766214178,
        (268442665, 67127839): 0.942684766214178,
        (268442665, 67144223): 0.942684766214178,
        (268442665, 134224677): 0.9683257918552036,
        (268442665, 134228773): 0.9547511312217195,
        (268442665, 134236965): 0.9547511312217195,
        (268442665, 134253349): 0.9547511312217195,
        (268442665, 268446761): 1.0,
        (268442665, 268454953): 1.0,
        (268442665, 268471337): 1.0,
        (268446761, 69634): 0.6817496229260935,
        (268446761, 73730): 0.7647058823529411,
        (268446761, 81922): 0.6817496229260935,
        (268446761, 98306): 0.6817496229260935,
        (268446761, 135427): 0.7239819004524887,
        (268446761, 139523): 0.8129713423831071,
        (268446761, 147715): 0.7239819004524887,
        (268446761, 164099): 0.7239819004524887,
        (268446761, 266757): 0.7481146304675717,
        (268446761, 270853): 0.8280542986425339,
        (268446761, 279045): 0.7481146304675717,
        (268446761, 295429): 0.7481146304675717,
        (268446761, 529159): 0.7918552036199095,
        (268446761, 533255): 0.8552036199095022,
        (268446761, 541447): 0.7918552036199095,
        (268446761, 557831): 0.7918552036199095,
        (268446761, 1053707): 0.7828054298642534,
        (268446761, 1057803): 0.8521870286576169,
        (268446761, 1065995): 0.7828054298642534,
        (268446761, 1082379): 0.7828054298642534,
        (268446761, 2102541): 0.8250377073906485,
        (268446761, 2106637): 0.8868778280542986,
        (268446761, 2114829): 0.8250377073906485,
        (268446761, 2131213): 0.8250377073906485,
        (268446761, 4199953): 0.8491704374057315,
        (268446761, 4204049): 0.9019607843137255,
        (268446761, 4212241): 0.8491704374057315,
        (268446761, 4228625): 0.8491704374057315,
        (268446761, 8394515): 0.8838612368024132,
        (268446761, 8398611): 0.9170437405731523,
        (268446761, 8406803): 0.8838612368024132,
        (268446761, 8423187): 0.8838612368024132,
        (268446761, 16783383): 0.9140271493212669,
        (268446761, 16787479): 0.9457013574660633,
        (268446761, 16795671): 0.9140271493212669,
        (268446761, 16812055): 0.9140271493212669,
        (268446761, 33560861): 0.9336349924585219,
        (268446761, 33564957): 0.9577677224736049,
        (268446761, 33573149): 0.9336349924585219,
        (268446761, 33589533): 0.9336349924585219,
        (268446761, 67115551): 0.942684766214178,
        (268446761, 67119647): 0.9607843137254902,
        (268446761, 67127839): 0.942684766214178,
        (268446761, 67144223): 0.942684766214178,
        (268446761, 134224677): 0.9547511312217195,
        (268446761, 134228773): 0.9683257918552036,
        (268446761, 134236965): 0.9547511312217195,
        (268446761, 134253349): 0.9547511312217195,
        (268454953, 69634): 0.6817496229260935,
        (268454953, 73730): 0.6817496229260935,
        (268454953, 81922): 0.7647058823529411,
        (268454953, 98306): 0.6817496229260935,
        (268454953, 135427): 0.7239819004524887,
        (268454953, 139523): 0.7239819004524887,
        (268454953, 147715): 0.8129713423831071,
        (268454953, 164099): 0.7239819004524887,
        (268454953, 266757): 0.7481146304675717,
        (268454953, 270853): 0.7481146304675717,
        (268454953, 279045): 0.8280542986425339,
        (268454953, 295429): 0.7481146304675717,
        (268454953, 529159): 0.7918552036199095,
        (268454953, 533255): 0.7918552036199095,
        (268454953, 541447): 0.8552036199095022,
        (268454953, 557831): 0.7918552036199095,
        (268454953, 1053707): 0.7828054298642534,
        (268454953, 1057803): 0.7828054298642534,
        (268454953, 1065995): 0.8521870286576169,
        (268454953, 1082379): 0.7828054298642534,
        (268454953, 2102541): 0.8250377073906485,
        (268454953, 2106637): 0.8250377073906485,
        (268454953, 2114829): 0.8868778280542986,
        (268454953, 2131213): 0.8250377073906485,
        (268454953, 4199953): 0.8491704374057315,
        (268454953, 4204049): 0.8491704374057315,
        (268454953, 4212241): 0.9019607843137255,
        (268454953, 4228625): 0.8491704374057315,
        (268454953, 8394515): 0.8838612368024132,
        (268454953, 8398611): 0.8838612368024132,
        (268454953, 8406803): 0.9170437405731523,
        (268454953, 8423187): 0.8838612368024132,
        (268454953, 16783383): 0.9140271493212669,
        (268454953, 16787479): 0.9140271493212669,
        (268454953, 16795671): 0.9457013574660633,
        (268454953, 16812055): 0.9140271493212669,
        (268454953, 33560861): 0.9336349924585219,
        (268454953, 33564957): 0.9336349924585219,
        (268454953, 33573149): 0.9577677224736049,
        (268454953, 33589533): 0.9336349924585219,
        (268454953, 67115551): 0.942684766214178,
        (268454953, 67119647): 0.942684766214178,
        (268454953, 67127839): 0.9607843137254902,
        (268454953, 67144223): 0.942684766214178,
        (268454953, 134224677): 0.9547511312217195,
        (268454953, 134228773): 0.9547511312217195,
        (268454953, 134236965): 0.9683257918552036,
        (268454953, 134253349): 0.9547511312217195,
        (268454953, 268446761): 1.0,
        (268471337, 69634): 0.6817496229260935,
        (268471337, 73730): 0.6817496229260935,
        (268471337, 81922): 0.6817496229260935,
        (268471337, 98306): 0.7647058823529411,
        (268471337, 135427): 0.7239819004524887,
        (268471337, 139523): 0.7239819004524887,
        (268471337, 147715): 0.7239819004524887,
        (268471337, 164099): 0.8129713423831071,
        (268471337, 266757): 0.7481146304675717,
        (268471337, 270853): 0.7481146304675717,
        (268471337, 279045): 0.7481146304675717,
        (268471337, 295429): 0.8280542986425339,
        (268471337, 529159): 0.7918552036199095,
        (268471337, 533255): 0.7918552036199095,
        (268471337, 541447): 0.7918552036199095,
        (268471337, 557831): 0.8552036199095022,
        (268471337, 1053707): 0.7828054298642534,
        (268471337, 1057803): 0.7828054298642534,
        (268471337, 1065995): 0.7828054298642534,
        (268471337, 1082379): 0.8521870286576169,
        (268471337, 2102541): 0.8250377073906485,
        (268471337, 2106637): 0.8250377073906485,
        (268471337, 2114829): 0.8250377073906485,
        (268471337, 2131213): 0.8868778280542986,
        (268471337, 4199953): 0.8491704374057315,
        (268471337, 4204049): 0.8491704374057315,
        (268471337, 4212241): 0.8491704374057315,
        (268471337, 4228625): 0.9019607843137255,
        (268471337, 8394515): 0.8838612368024132,
        (268471337, 8398611): 0.8838612368024132,
        (268471337, 8406803): 0.8838612368024132,
        (268471337, 8423187): 0.9170437405731523,
        (268471337, 16783383): 0.9140271493212669,
        (268471337, 16787479): 0.9140271493212669,
        (268471337, 16795671): 0.9140271493212669,
        (268471337, 16812055): 0.9457013574660633,
        (268471337, 33560861): 0.9336349924585219,
        (268471337, 33564957): 0.9336349924585219,
        (268471337, 33573149): 0.9336349924585219,
        (268471337, 33589533): 0.9577677224736049,
        (268471337, 67115551): 0.942684766214178,
        (268471337, 67119647): 0.942684766214178,
        (268471337, 67127839): 0.942684766214178,
        (268471337, 67144223): 0.9607843137254902,
        (268471337, 134224677): 0.9547511312217195,
        (268471337, 134228773): 0.9547511312217195,
        (268471337, 134236965): 0.9547511312217195,
        (268471337, 134253349): 0.9683257918552036,
        (268471337, 268446761): 1.0,
        (268471337, 268454953): 1.0,
    }

    def __init__(self):
        """
        Calculates lookup tables
        """
        # create dictionaries
        self.flush_lookup = {}
        self.unsuited_lookup = {}

        # create the lookup table in piecewise fashion
        self.flushes()  # this will call straights and high cards method,
        # we reuse some of the bit sequences
        self.multiples()

    def flushes(self):
        """
        Straight flushes and flushes.

        Lookup is done on 13 bit integer (2^13 > 7462):
        xxxbbbbb bbbbbbbb => integer hand index
        """

        # straight flushes in rank order
        straight_flushes = [
            7936,  # int('0b1111100000000', 2), # royal flush
            3968,  # int('0b111110000000', 2),
            1984,  # int('0b11111000000', 2),
            992,  # int('0b1111100000', 2),
            496,  # int('0b111110000', 2),
            248,  # int('0b11111000', 2),
            124,  # int('0b1111100', 2),
            62,  # int('0b111110', 2),
            31,  # int('0b11111', 2),
            4111  # int('0b1000000001111', 2) # 5 high
        ]

        # now we'll dynamically generate all the other
        # flushes (including straight flushes)
        flushes = []
        gen = self.get_lexographically_next_bit_sequence(int('0b11111', 2))

        # 1277 = number of high cards
        # 1277 + len(str_flushes) is number of hands with all cards unique rank
        for i in range(1277 + len(straight_flushes) - 1):  # we also iterate over SFs
            # pull the next flush pattern from our generator
            f = next(gen)

            # if this flush matches perfectly any
            # straight flush, do not add it
            notSF = True
            for sf in straight_flushes:
                # if f XOR sf == 0, then bit pattern
                # is same, and we should not add
                if not f ^ sf:
                    notSF = False

            if notSF:
                flushes.append(f)

        # we started from the lowest straight pattern, now we want to start ranking from
        # the most powerful hands, so we reverse
        flushes.reverse()

        # now add to the lookup map:
        # start with straight flushes and the rank of 1
        # since theyit is the best hand in poker
        # rank 1 = Royal Flush!
        rank = 1
        for sf in straight_flushes:
            prime_product = Card.prime_product_from_rankbits(sf)
            self.flush_lookup[prime_product] = rank
            rank += 1

        # we start the counting for flushes on max full house, which
        # is the worst rank that a full house can have (2,2,2,3,3)
        rank = LookupTable.MAX_FULL_HOUSE + 1
        for f in flushes:
            prime_product = Card.prime_product_from_rankbits(f)
            self.flush_lookup[prime_product] = rank
            rank += 1

        # we can reuse these bit sequences for straights
        # and high cards since they are inherently related
        # and differ only by context
        self.straight_and_highcards(straight_flushes, flushes)

    def straight_and_highcards(self, straights, highcards):
        """
        Unique five card sets. Straights and highcards.

        Reuses bit sequences from flush calculations.
        """
        rank = LookupTable.MAX_FLUSH + 1

        for s in straights:
            prime_product = Card.prime_product_from_rankbits(s)
            self.unsuited_lookup[prime_product] = rank
            rank += 1

        rank = LookupTable.MAX_PAIR + 1
        for h in highcards:
            prime_product = Card.prime_product_from_rankbits(h)
            self.unsuited_lookup[prime_product] = rank
            rank += 1

    def multiples(self):
        """
        Pair, Two Pair, Three of a Kind, Full House, and 4 of a Kind.
        """
        backwards_ranks = list(range(len(Card.INT_RANKS) - 1, -1, -1))

        # 1) Four of a Kind
        rank = LookupTable.MAX_STRAIGHT_FLUSH + 1

        # for each choice of a set of four rank
        for i in backwards_ranks:

            # and for each possible kicker rank
            kickers = backwards_ranks[:]
            kickers.remove(i)
            for k in kickers:
                product = Card.PRIMES[i] ** 4 * Card.PRIMES[k]
                self.unsuited_lookup[product] = rank
                rank += 1

        # 2) Full House
        rank = LookupTable.MAX_FOUR_OF_A_KIND + 1

        # for each three of a kind
        for i in backwards_ranks:

            # and for each choice of pair rank
            pairranks = backwards_ranks[:]
            pairranks.remove(i)
            for pr in pairranks:
                product = Card.PRIMES[i] ** 3 * Card.PRIMES[pr] ** 2
                self.unsuited_lookup[product] = rank
                rank += 1

        # 3) Three of a Kind
        rank = LookupTable.MAX_STRAIGHT + 1

        # pick three of one rank
        for r in backwards_ranks:

            kickers = backwards_ranks[:]
            kickers.remove(r)
            gen = itertools.combinations(kickers, 2)

            for kickers in gen:
                c1, c2 = kickers
                product = Card.PRIMES[r] ** 3 * Card.PRIMES[c1] * Card.PRIMES[c2]
                self.unsuited_lookup[product] = rank
                rank += 1

        # 4) Two Pair
        rank = LookupTable.MAX_THREE_OF_A_KIND + 1

        tpgen = itertools.combinations(backwards_ranks, 2)
        for tp in tpgen:

            pair1, pair2 = tp
            kickers = backwards_ranks[:]
            kickers.remove(pair1)
            kickers.remove(pair2)
            for kicker in kickers:
                product = Card.PRIMES[pair1] ** 2 * Card.PRIMES[pair2] ** 2 * Card.PRIMES[kicker]
                self.unsuited_lookup[product] = rank
                rank += 1

        # 5) Pair
        rank = LookupTable.MAX_TWO_PAIR + 1

        # choose a pair
        for pairrank in backwards_ranks:

            kickers = backwards_ranks[:]
            kickers.remove(pairrank)
            kgen = itertools.combinations(kickers, 3)

            for kickers in kgen:
                k1, k2, k3 = kickers
                product = Card.PRIMES[pairrank] ** 2 * Card.PRIMES[k1] \
                          * Card.PRIMES[k2] * Card.PRIMES[k3]
                self.unsuited_lookup[product] = rank
                rank += 1

    def write_table_to_disk(self, table, filepath):
        """
        Writes lookup table to disk
        """
        with open(filepath, 'w') as f:
            for prime_prod, rank in table.items():
                f.write(str(prime_prod) + "," + str(rank) + '\n')

    def get_lexographically_next_bit_sequence(self, bits):
        """
        Bit hack from here:
        http://www-graphics.stanford.edu/~seander/bithacks.html#NextBitPermutation

        Generator even does this in poker order rank
        so no need to sort when done! Perfect.
        """
        t = (bits | (bits - 1)) + 1
        next = t | ((((t & -t) // (bits & -bits)) >> 1) - 1)
        yield next
        while True:
            t = (next | (next - 1)) + 1
            next = t | ((((t & -t) // (next & -next)) >> 1) - 1)
            yield next